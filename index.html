<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>青瓜平台</title>
    <link rel="stylesheet" href="/css/reset.css">
    <link rel="stylesheet" href="/js/lib/layui/css/layui.css">
    <link rel="stylesheet" href="/css/other.css">
    <link rel="stylesheet" href="/css/search-list.css">
</head>

<body style="display: none;">
    <!-- 页面头部元素 -->
    <div id="page-header"></div>
    <!-- 页面容器元素 -->
    <div class="page-container">
        <div class="page-banner">
            <h1>让商务对接更简单</h1>
            <div class="page-banner--line"></div>
            <p>青瓜传媒 拥有垂直核心技术、百万资源、行业专业技术和服务能力</p>
            <p>拥有垂直核心技术、百万资源、</p>
            <div class="page-banner-btns">
                <div class="first-party">
                    <h2>甲方需求</h2>
                    <span>代运营 MAC机构 KOL</span>
                </div>
                <div class="second-party">
                    <h2>乙方服务</h2>
                    <span>生活服务 居家建材 企业服务 工业制造 广告传媒</span>
                </div>
            </div>
        </div>
        <div id="search-box" class="different-bg">
            <div class="search-list" style="display: block;">
                <div class="search-list__header">
                    <div class="search-list__header-inner">
                        <div class="search-list__header-top">
                            <div class="ipt-box">
                                <img src="/images/search.png">
                                <input id="search-input" type="text" placeholder="请输入公司名称/姓名/地区/资源关键字">
                                <button type="button" class="layui-btn layui-btn-radius search-btn">搜索</button>
                            </div>
                            <button type="button"
                                class="layui-btn layui-btn-radius layui-btn-normal send-btn">发布需求</button>
                        </div>
                        <div class="search-list__header-hot">
                            <label>热门搜索：</label>
                            <span><img src="/images/hot.png">销售渠道</span>
                            <span><img src="/images/hot.png">优质货源</span>
                            <span><img src="/images/hot.png">推广甲方</span>
                            <span>效果渠道</span>
                            <span>招商加盟</span>
                            <span>资源互换</span>
                            <span>流量互换</span>
                            <span>采购需求</span>
                            <span>线下广告</span>
                            <span>实体广告</span>
                        </div>
                    </div>
                </div>
                <div class="search-list__list">
                    <div class="search-list__list-content">
                        <div class="search-list__list-header">
                            <span class="w250">姓名</span>
                            <span class="w250">公司</span>
                            <span class="w370">介绍</span>
                            <span class="w200">操作</span>
                            <span class="f1">发布时间</span>
                        </div>
                        <div class="search-list__list-table" id="search-list__cont">
                            <div class="table-box">
                                <div class="table-row">
                                    <div class="record">推荐</div>
                                    <div class="w250 table-col">
                                        <div class="head-status">
                                            <span style="background:#FD6011">置顶</span><span
                                                style="background:#21CAA8">提供</span>
                                        </div>
                                        <div class="head-portrait">
                                            <img class="user-header" src="images/user.jpg">
                                        </div>
                                        <div class="user-info">
                                            <h3>王大全
                                                <img src="/images/zyicon.png"><img src="/images/V1.png">
                                            </h3>
                                            <div class="user-tag">
                                                <span>商务</span><span>广州</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="w250 table-col">
                                        青岛海米有限公司
                                    </div>
                                    <div class="w370 table-col ellips2">
                                        专注供应链带货合作。我能提供的：国内外优质工厂祸患，上百种可以合作的卖货啊啥的产品
                                    </div>
                                    <div class="w200 table-col">
                                        <button type="button"
                                            class="layui-btn layui-btn-radius show-btn">查看联系方式</button>
                                    </div>
                                    <div class="f1 table-col" style="color:#828898;">
                                        2小时前
                                    </div>
                                </div>
                                <div class="table-box--slide">
                                    <div class="slide-row">
                                        <div class="slide-row--col1">
                                            <div class="icon">
                                                <img src="/images/wechat.png">
                                                <label>微信号：</label>
                                            </div>
                                            <p>372374245</p>
                                        </div>
                                        <div class="slide-row--col2">
                                            <div class="icon">
                                                <img src="/images/zy.png">
                                                <label>资源类型：</label>
                                            </div>
                                            <p>商品资源</p>
                                        </div>
                                    </div>
                                    <div class="slide-row">
                                        <div class="slide-row--col1">
                                            <div class="icon">
                                                <img src="/images/ls-phone.png">
                                                <label>手机号：</label>
                                            </div>
                                            <p>15937482323</p>
                                        </div>
                                        <div class="slide-row--col2">
                                            <div class="icon">
                                                <img src="/images/accout.png">
                                                <label>账号类型：</label>
                                            </div>
                                            <p>服装</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="search-list__list-page">
                        <div id="search-page"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 页面底部 -->
    <div id="page-footer"></div>
    <script src="/js/lib/jquery.min.js"></script>
    <script src="/js/lib/layui/layui.js"></script>
    <script src="/js/search-list.js"></script>
    <script>
        $(function () {
            layui.use(['layer', 'form', 'laypage'], function () {
                var layer = layui.layer,
                    laypage = layui.laypage;
                //搜索参数
                var params = {
                    param: '',
                    keyword: '',
                    page: '1'
                };
                //总条数
                var count = 50;
                //点击热词请求接口
                $('span', '.search-list__header-hot').off('click').on('click', function () {
                    var val = $(this).text()
                    params.page = 1;
                    params.keyword = val;
                    init(params);
                })

                //点击搜索  根据值筛选搜索结果
                $('.search-btn').off('click').on('click', function () {
                    var val = $('#search-input').val().trim();
                    params.page = 1;
                    params.keyword = val;
                    init(params);
                })
                //首次加载页面请求接口
                init(params)
                //初始化数据
                function init(params) {
                    $.ajax({
                        type: 'POST',
                        async: false, //false 为同步  true 为异步  默认为异步
                        url: 'http://qg.158wx.com/api/business/search',
                        data: params,
                        dataType: 'jsonp',
                        success: res => {
                            if (res.code === 1) {
                                // debugger
                                count = res.data.total;
                                initHtml(res.data.list);
                                handlePage(params.page)
                            }
                        },
                        error: function () {
                            console.log('error')
                        }
                    })
                }

                //初始化页面HTML
                function initHtml(data) {
                    var $el = $('#search-list__cont'),
                        html = '';
                    html = data.map(item => {
                        return `<div class="table-box">
                                    <div class="table-row">
                                        <div class="w250 table-col">
                                            <div class="head-status">
                                                <span style="background:#409EFF">需要</span>
                                            </div>
                                            <div class="head-portrait">
                                                <img class="user-header" src="${item.user.avatar || '/images/user.jpg'}">
                                            </div>
                                            <div class="user-info">
                                                <h3>${item.user.nickname}
                                                    <img src="/images/qyicon.png"><img src="/images/v2.png">
                                                </h3>
                                                <div class="user-tag">
                                                    <span>商务</span><span>广州</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="w250 table-col">
                                            ${item.user.company.fullname}
                                        </div>
                                        <div class="w370 table-col ellips2">
                                            ${item.user.company.introduce}
                                        </div>
                                        <div class="w200 table-col">
                                            <button type="button"
                                                class="layui-btn layui-btn-radius show-btn">查看联系方式</button>
                                        </div>
                                        <div class="f1 table-col" style="color:#828898;">
                                            15分钟前
                                        </div>
                                    </div>
                                    <div class="table-box--slide">
                                        <div class="slide-row">
                                            <div class="slide-row--col1">
                                                <div class="icon">
                                                    <img src="/images/wechat.png">
                                                    <label>微信号：</label>
                                                </div>
                                                <p>${item.wxid}</p>
                                            </div>
                                            <div class="slide-row--col2">
                                                <div class="icon">
                                                    <img src="/images/zy.png">
                                                    <label>资源类型：</label>
                                                </div>
                                                <p>商品资商品资源商品资源商品资源源</p>
                                            </div>
                                        </div>
                                        <div class="slide-row">
                                            <div class="slide-row--col1">
                                                <div class="icon">
                                                    <img src="/images/ls-phone.png">
                                                    <label>手机号：</label>
                                                </div>
                                                <p>${item.user.mobile}</p>
                                            </div>
                                            <div class="slide-row--col2">
                                                <div class="icon">
                                                    <img src="/images/accout.png">
                                                    <label>账号类型：</label>
                                                </div>
                                                <p>商商品资源商品资源品资源</p>
                                            </div>
                                        </div>
                                    </div>
                            </div>`
                    }).join('');
                    $el.empty().append(html)
                }


                function handlePage(page) {
                    //分页跳转功能
                    laypage.render({
                        elem: 'search-page'
                        , count: count,
                        curr: page,
                        prev: '<img src="/images/prev.png" style="width: 14px;"/>',
                        next: '<img src="/images/next.png" style="width: 14px;"/>'
                        , layout: ['count', 'prev', 'page', 'next', 'skip']
                        , jump: function (obj, first) { //分页跳转  obj 跳转结果
                            if (!first) {
                                params.page = obj.curr;
                                init(params)
                            }

                            // 
                        }
                    });
                }



                //发布需求
                $('.send-btn').off('click').on('click', function () {
                    //dosome
                })


                $('.first-party').on('click', function () {
                    location.href = "/release-requirements.html?type=1"
                })

                $('.second-party').off('click').on('click', function () {
                    location.href = "/release-requirements.html?type=2"
                })
                //加载头部
                $('#page-header').load('/layout/header.html')
                //加载底部
                $('#page-footer').load('/layout/footer.html')

                setTimeout(() => {
                    $('body').css('display', 'block')
                }, 100)

            })
        })
    </script>
</body>

</html>